{"ast":null,"code":"import _toConsumableArray from\"/Users/valeria/Desktop/Files/wep-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/valeria/Desktop/Files/wep-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import'./ProductList.css';import ProductItem from\"../ProductItem/ProductItem\";import{useTelegram}from\"../../hooks/useTelegram\";import{useCallback,useEffect}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";var products=[{id:'1',title:'Джинсы',price:5000,description:'Синего цвета, прямые'},{id:'2',title:'Куртка',price:12000,description:'Зеленого цвета, теплая'},{id:'3',title:'Джинсы 2',price:5000,description:'Синего цвета, прямые'},{id:'4',title:'Куртка 8',price:122,description:'Зеленого цвета, теплая'},{id:'5',title:'Джинсы 3',price:5000,description:'Синего цвета, прямые'},{id:'6',title:'Куртка 7',price:600,description:'Зеленого цвета, теплая'},{id:'7',title:'Джинсы 4',price:5500,description:'Синего цвета, прямые'},{id:'8',title:'Куртка 5',price:12000,description:'Зеленого цвета, теплая'}];var getTotalPrice=function getTotalPrice(){var items=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];return items.reduce(function(acc,item){return acc+=item.price;},0);};var ProductList=function ProductList(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),addedItems=_useState2[0],setAddedItems=_useState2[1];var _useTelegram=useTelegram(),tg=_useTelegram.tg,queryId=_useTelegram.queryId;var onSendData=useCallback(function(){var data={products:addedItems,totalPrice:getTotalPrice(addedItems),queryId:queryId};fetch('http://85.119.146.179:8000/web-data',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});},[addedItems]);useEffect(function(){tg.onEvent('mainButtonClicked',onSendData);return function(){tg.offEvent('mainButtonClicked',onSendData);};},[onSendData]);var onAdd=function onAdd(product){var alreadyAdded=addedItems.find(function(item){return item.id===product.id;});var newItems=[];if(alreadyAdded){newItems=addedItems.filter(function(item){return item.id!==product.id;});}else{newItems=[].concat(_toConsumableArray(addedItems),[product]);}setAddedItems(newItems);if(newItems.length===0){tg.MainButton.hide();}else{tg.MainButton.show();tg.MainButton.setParams({text:\"\\u041A\\u0443\\u043F\\u0438\\u0442\\u044C \".concat(getTotalPrice(newItems))});}};return/*#__PURE__*/_jsx(\"div\",{className:'list',children:products.map(function(item){return/*#__PURE__*/_jsx(ProductItem,{product:item,onAdd:onAdd,className:'item'});})});};export default ProductList;","map":{"version":3,"names":["React","useState","ProductItem","useTelegram","useCallback","useEffect","products","id","title","price","description","getTotalPrice","items","reduce","acc","item","ProductList","addedItems","setAddedItems","tg","queryId","onSendData","data","totalPrice","fetch","method","headers","body","JSON","stringify","onEvent","offEvent","onAdd","product","alreadyAdded","find","newItems","filter","length","MainButton","hide","show","setParams","text","map"],"sources":["/Users/valeria/Desktop/Files/wep-app/src/components/ProductList/ProductList.jsx"],"sourcesContent":["import React, {useState} from 'react';\nimport './ProductList.css';\nimport ProductItem from \"../ProductItem/ProductItem\";\nimport {useTelegram} from \"../../hooks/useTelegram\";\nimport {useCallback, useEffect} from \"react\";\n\nconst products = [\n    {id: '1', title: 'Джинсы', price: 5000, description: 'Синего цвета, прямые'},\n    {id: '2', title: 'Куртка', price: 12000, description: 'Зеленого цвета, теплая'},\n    {id: '3', title: 'Джинсы 2', price: 5000, description: 'Синего цвета, прямые'},\n    {id: '4', title: 'Куртка 8', price: 122, description: 'Зеленого цвета, теплая'},\n    {id: '5', title: 'Джинсы 3', price: 5000, description: 'Синего цвета, прямые'},\n    {id: '6', title: 'Куртка 7', price: 600, description: 'Зеленого цвета, теплая'},\n    {id: '7', title: 'Джинсы 4', price: 5500, description: 'Синего цвета, прямые'},\n    {id: '8', title: 'Куртка 5', price: 12000, description: 'Зеленого цвета, теплая'},\n]\n\nconst getTotalPrice = (items = []) => {\n    return items.reduce((acc, item) => {\n        return acc += item.price\n    }, 0)\n}\n\nconst ProductList = () => {\n    const [addedItems, setAddedItems] = useState([]);\n    const {tg, queryId} = useTelegram();\n\n    const onSendData = useCallback(() => {\n        const data = {\n            products: addedItems,\n            totalPrice: getTotalPrice(addedItems),\n            queryId,\n        }\n        fetch('http://85.119.146.179:8000/web-data', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify(data)\n        })\n    }, [addedItems])\n\n    useEffect(() => {\n        tg.onEvent('mainButtonClicked', onSendData)\n        return () => {\n            tg.offEvent('mainButtonClicked', onSendData)\n        }\n    }, [onSendData])\n\n    const onAdd = (product) => {\n        const alreadyAdded = addedItems.find(item => item.id === product.id);\n        let newItems = [];\n\n        if(alreadyAdded) {\n            newItems = addedItems.filter(item => item.id !== product.id);\n        } else {\n            newItems = [...addedItems, product];\n        }\n\n        setAddedItems(newItems)\n\n        if(newItems.length === 0) {\n            tg.MainButton.hide();\n        } else {\n            tg.MainButton.show();\n            tg.MainButton.setParams({\n                text: `Купить ${getTotalPrice(newItems)}`\n            })\n        }\n    }\n\n    return (\n        <div className={'list'}>\n            {products.map(item => (\n                <ProductItem\n                    product={item}\n                    onAdd={onAdd}\n                    className={'item'}\n                />\n            ))}\n        </div>\n    );\n};\n\nexport default ProductList;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}